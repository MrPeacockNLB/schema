# yaml-language-server: $schema=schema.json
# see https://github.com/nordlb-cloud/devops-k8s-modules/tree/main/schemas#ide-integration for installation
---

coder:
  #
  # Basic configuration
  #
  workspace:
    requests:
      cpu: "1"
      memory: 1Gi
    limits:
      cpu: "2"
      memory: 2Gi
    dind:
      enable: true # defaults to false
      limits:
        cpu: "2"
        memory: 2Gi
    image: dockerimage:latest
    init_script_timeout: 3600  # in seconds
    git:
      enable_precommit: true  # true or false
      merge_strategy:   merge # merge or rebase
      additional_repos:
        - description: "library XY"
          git_orga: "nordlb-coder"
          git_repo: "library"
          git_ref: "main" 
    env:
      - name: TEST      
        value: "333"
      - name: test2
        value: ddd
    shell:
      editor:      tilde # tilde should be default. nano, vim, vi. should be supported too
      enable_tmux: true  # Multiplex Shell sessions by default. Defaults to false.

  #
  # VSCode settings
  #
  vscode:
    enable: true
    install_vsix: true # install any vsix file found in /workspace 
    extensions:
      - id: hashicorp.terraform # Terraform

  intellij:
    enable: false
    idePath: /opt/idea # e.G.

  #
  # Jobs
  #
  jobs:
    - name: installTerraform
      cmd: yay -S --noconfirm terraform
      description: Für die Tests in dem Workspace wird terraform benötigt

  #
  # Applications
  #
  apps:
    - display_name: code-server
      slug: code-server
      icon: "/icon/code.svg"
      url: "http://localhost:13337?folder=/workspace/workdir"
      subdomain: false
      share: "owner"

      healthcheck:
        url: "http://localhost:13337/healthz"
        interval: 3
        threshold: 10
